"use strict";$(function(){getCookie("nickname");var o=JSON.parse(window.localStorage.getItem("cart"))||[];if(console.log(o),!o.length)return $(".cart-on").addClass("hide"),void $(".cart-off").removeClass("hide");function a(){var n=o.every(function(n){return"1"==n.is_select}),t=0,a=0;o.forEach(function(n){"1"===n.is_select&&(t+=+n.cart_number,a+=n.cart_number*n.goods_price)});var c='\n            <div class="panel panel-info">\n            <div class="panel-heading cart-heading">\n            <ul class="shopping-title">\n                <li class="f1"><input type="checkbox" '.concat(n?"checked":"",' /><span>全选:</span></li>\n                <li class="f2">商品信息</li>\n                <li class="f3">单价</li>\n                <li class="f4">数量</li>\n                <li class="f4">金额</li>\n                <li class="f5">操作</li>\n            </ul>\n            </div>\n            <div class="panel-body cart-body">\n                <ul class="goodsList">\n        ');o.forEach(function(n){c+='\n                <li>\n                    <div class="select">\n                        <input class="inpChecked" data-id="'.concat(n.goods_id,'" type="checkbox" ').concat("0"===n.is_select?"":"checked",' />\n                    </div>\n                    <div class="goodsImg">\n                        <img src="').concat(n.goods_small_logo,'" alt="" />\n                    </div>\n                    <div class="goodsDesc">\n                        <p>').concat(n.goods_name,'</p>\n                    </div>\n                    <div class="price">￥ <span class="text-danger">').concat(n.goods_price,'</span></div>\n                    <div class="count">\n                        <button class="subNum" data-id="').concat(n.goods_id,'">-</button>\n                        <input type="text" data-id="').concat(n.goods_id,'" value="').concat(n.cart_number,'" class="cartNum" />\n                        <button class="addNum" data-id="').concat(n.goods_id,'">+</button>\n                    </div>\n                    <div class="xiaoji">\n                        <span class="text-danger">').concat((n.goods_price*n.cart_number).toFixed(2),'</span>\n                    </div>\n                    <div class="operate">\n                        <button class="btn btn-danger del" data-id="').concat(n.goods_id,'">删除</button>\n                    </div>\n                </li>\n            ')}),c+='\n            </ul>\n            </div>\n            <div class="panel-footer">\n            <div class="row buyInfo">\n                <p class="col-sm-4 buyNum">\n                购买总数量: <span class="text-danger cartNum">'.concat(t,'</span> 件商品\n                </p>\n                <p class="col-sm-4 buyMoney">\n                购买总价格: <span class="text-danger total">').concat(a.toFixed(2),'</span> 元\n                </p>\n                <p class="col-sm-4 operate">\n                <button class="btn btn-success" ').concat(0===a?"disabled":"",'>立即付款</button>\n                <button class="btn btn-danger clearCart">清空购物车</button>\n                <button class="btn btn-primary continue">\n                    <a href="./list.html">继续购物</a>\n                </button>\n                </p>\n            </div>\n            </div>\n        </div>\n        '),$(".cart-on").html(c),$(".continue > a").css({color:"#FFF",textDecoration:"none"})}$(".cart-off").addClass("hide"),$(".cart-on").removeClass("hide"),a(),$(".cart-on").on("click",".select > input",function(){var n=this.checked,t=$(this).data("id");o.filter(function(n){return n.goods_id==t})[0].is_select=n?"1":"0",a(),window.localStorage.setItem("cart",JSON.stringify(o))}).on("click",".addNum",function(){var t=$(this).data("id"),n=o.filter(function(n){return n.goods_id==t})[0];n.cart_number=+n.cart_number+1,a(),window.localStorage.setItem("cart",JSON.stringify(o))}).on("click",".subNum",function(){var t=$(this).data("id"),n=o.filter(function(n){return n.goods_id==t})[0];1!==n.cart_number&&(n.cart_number=+n.cart_number-1,a(),window.localStorage.setItem("cart",JSON.stringify(o)))}).on("mouseout",".count > .cartNum",function(){var t=$(this).data("id"),n=o.filter(function(n){return n.goods_id==t})[0];1!==n.cart_number&&(n.cart_number=$(this).val(),a(),window.localStorage.setItem("cart",JSON.stringify(o)))}).on("click",".f1 > input",function(){this.checked?o.forEach(function(n){return n.is_select="1"}):o.forEach(function(n){return n.is_select="0"}),a(),window.localStorage.setItem("cart",JSON.stringify(o)),window.localStorage.setItem("cart",JSON.stringify(o))}).on("click",".del",function(){for(var n=$(this).data("id"),t=0;t<o.length;t++)if(o[t].goods_id==n){o.splice(t,1);break}if(a(),window.localStorage.setItem("cart",JSON.stringify(o)),!o.length)return window.location.reload()}).on("click",".clearCart",function(){if(o.length=0,a(),window.localStorage.setItem("cart",JSON.stringify(o)),!o.length)return window.location.reload()})});